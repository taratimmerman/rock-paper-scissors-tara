let e={ROCK:{id:"rock",beats:["scissors"],isStandard:!0,text:"Rock",icon:"ðŸª¨"},PAPER:{id:"paper",beats:["rock"],isStandard:!0,text:"Paper",icon:"ðŸ“„"},SCISSORS:{id:"scissors",beats:["paper"],isStandard:!0,text:"Scissors",icon:"âœ‚ï¸"},TARA:{id:"tara",beats:["rock","paper","scissors"],isStandard:!1,text:"Tara",icon:"â­"}},t=Object.values(e),s=Object.fromEntries(Object.entries(e).map(([e,t])=>[e,t.id])),a=t.map(e=>({name:e.id,beats:e.beats})),i=t.map(e=>e.id),r=new Map(a.map(e=>[e.name,e])),o=a.filter((e,s)=>t[s].isStandard),n=o.map(e=>e.name);o.map(e=>[e.name,e]);let l=t.map(e=>({id:e.id,text:e.text,icon:e.icon})),m=Object.fromEntries(t.map(e=>[e.id,e.text])),h="player",u="computer",c={matchRoundNumber:1,playerHealth:100,computerHealth:100},d={player:"playerHealth",computer:"computerHealth"},g="Score",p="TaraCount",v="MostCommonMove",M="MoveCounts",y="roundNumber",C="globalMatchNumber",S="currentMatch",w={[s.ROCK]:0,[s.PAPER]:0,[s.SCISSORS]:0};class _{formatKey(e,t){return`${e}${t}`}safelySetItem(e,t){try{localStorage.setItem(e,t)}catch(t){console.warn(`LocalStorage Error: Failed to save "${e}".`,t)}}getScore(e){let t=this.formatKey(e,g);return parseInt(localStorage.getItem(t)||"0",10)}getTaraCount(e){let t=this.formatKey(e,p);return parseInt(localStorage.getItem(t)||"0",10)}getMostCommonMove(e){let t=this.formatKey(e,v),s=localStorage.getItem(t);return s&&n.includes(s)?s:null}getMoveCounts(e){let t=this.formatKey(e,M);try{let e=localStorage.getItem(t);return e?JSON.parse(e):w}catch(e){return console.warn(`LocalStorage Error: Failed to parse "${t}".`,e),w}}getGlobalMatchNumber(){let e=localStorage.getItem(C);return null!==e?parseInt(e,10):null}getMatch(){try{let e=localStorage.getItem(S);return e?JSON.parse(e):null}catch(e){return console.warn("LocalStorage Error: Failed to parse currentMatch.",e),null}}getOldGlobalRoundNumber(){let e=localStorage.getItem(y);if(null===e)return null;let t=parseInt(e,10);return isNaN(t)?(console.warn(`Legacy 'roundNumber' in localStorage (${e}) is not a valid number. Skipping migration.`),null):t}setScore(e,t){let s=this.formatKey(e,g);this.safelySetItem(s,t.toString())}setTaraCount(e,t){let s=this.formatKey(e,p);this.safelySetItem(s,t.toString())}setMostCommonMove(e,t){let s=this.formatKey(e,v);t?this.safelySetItem(s,t):localStorage.removeItem(s)}setMoveCounts(e,t){let s=this.formatKey(e,M);this.safelySetItem(s,JSON.stringify(t))}setGlobalMatchNumber(e){e?this.safelySetItem(C,e.toString()):localStorage.removeItem(C)}setMatch(e){e?this.safelySetItem(S,JSON.stringify(e)):localStorage.removeItem(S)}removeScore(e){let t=this.formatKey(e,g);localStorage.removeItem(t)}removeTaraCount(e){let t=this.formatKey(e,p);localStorage.removeItem(t)}removeMostCommonMove(e){let t=this.formatKey(e,v);localStorage.removeItem(t)}removeMoveCounts(e){let t=this.formatKey(e,M);localStorage.removeItem(t)}removeHistory(e){let t=this.formatKey(e,"History");localStorage.removeItem(t)}removeGlobalMatchNumber(){localStorage.removeItem(C)}removeOldGlobalRoundNumber(){localStorage.removeItem(y)}}class b{state={scores:{player:0,computer:0},moves:{player:null,computer:null},taras:{player:0,computer:0},mostCommonMove:{player:null,computer:null},moveCounts:{player:{rock:0,paper:0,scissors:0},computer:{rock:0,paper:0,scissors:0}},globalMatchNumber:null,currentMatch:null};gameStorage;constructor(e=new _){this.gameStorage=e,this.state.scores.player=this.gameStorage.getScore(h),this.state.scores.computer=this.gameStorage.getScore(u),this.state.taras.player=this.gameStorage.getTaraCount(h),this.state.taras.computer=this.gameStorage.getTaraCount(u),this.state.mostCommonMove.player=this.gameStorage.getMostCommonMove(h),this.state.mostCommonMove.computer=this.gameStorage.getMostCommonMove(u),this.state.moveCounts.player=this.gameStorage.getMoveCounts(h),this.state.moveCounts.computer=this.gameStorage.getMoveCounts(u),this._loadOrMigrateMatchState()}doesMoveBeat(e,t){return r.get(e)?.beats.includes(t)??!1}handleRoundWin(e,t){if(this.isStandardMove(t)){let t=this.getTaraCount(e);t<3&&this.setTaraCount(e,t+1)}}evaluateRound(){let e=this.getPlayerMove(),t=this.getComputerMove();if(null===e||null===t)return"Invalid round";this.handleTaraMove(h,e),this.handleTaraMove(u,t),e=this.getPlayerMove(),t=this.getComputerMove();let a=this.isTie(),i=e===s.TARA||t===s.TARA,r=this.getDamageAmount(a,i);return a?(this.decrementHealth(h,r),this.decrementHealth(u,r),"It's a tie!"):this.doesMoveBeat(e,t)?(this.handleRoundWin(h,e),this.decrementHealth(u,r),"You win the round!"):(this.handleRoundWin(u,t),this.decrementHealth(h,r),"Computer wins the round!")}isMatchActive(){return null!==this.gameStorage.getMatch()}setScore(e,t){this.state.scores[e]=t,this.gameStorage.setScore(e,t)}getScore(e){return this.state.scores[e]}resetScore(e){this.state.scores[e]=0,this.gameStorage.removeScore(e)}setPlayerScore(e){this.setScore(h,e)}setComputerScore(e){this.setScore(u,e)}getPlayerScore(){return this.getScore(h)}getComputerScore(){return this.getScore(u)}resetScores(){this.resetScore(h),this.resetScore(u)}isStandardMove(e){return"string"==typeof e&&e!==s.TARA}setMove(e,t){this.state.moves[e]=t}getMove(e){return this.state.moves[e]}determineMostCommonMove(e){let t=null,s=0,a=!1;for(let[i,r]of Object.entries(e))r>s?(s=r,t=i,a=!1):r===s&&0!==r&&(a=!0);return a?null:t}resetMostCommonMove(e){this.state.mostCommonMove[e]=null,this.gameStorage.removeMostCommonMove(e)}setMostCommonMove(e,t){let s=this.determineMostCommonMove(t);this.state.mostCommonMove[e]=s,this.gameStorage.setMostCommonMove(e,s)}getMostCommonMove(e){return this.state.mostCommonMove[e]}getAvailableMoves(e){return e?i:n}getBaseWeights(){return{[s.ROCK]:1,[s.PAPER]:1,[s.SCISSORS]:1,[s.TARA]:0}}getTaraWeight(e){if(!e.includes(s.TARA))return null;let{player:t,computer:a}=this.state.scores,i=t-a;return i>0?Math.min(3+i,10):i<0?1:2}getStandardMoveWeights(){let e={[s.ROCK]:1,[s.PAPER]:1,[s.SCISSORS]:1},t=this.state.mostCommonMove.player;if(!t)return e;let a={[s.ROCK]:s.PAPER,[s.PAPER]:s.SCISSORS,[s.SCISSORS]:s.ROCK}[t];return{[s.ROCK]:a===s.ROCK?5:2,[s.PAPER]:a===s.PAPER?5:2,[s.SCISSORS]:a===s.SCISSORS?5:2}}chooseWeightedRandomMove(e,t){let s=e.flatMap(e=>Array(t[e]).fill(e)),a=Math.floor(Math.random()*s.length);return s[a]}getComputerMoveWeights(e){let t=this.getBaseWeights(),a=this.getTaraWeight(e),i=this.getStandardMoveWeights();return{...t,...i,...null!==a?{[s.TARA]:a}:{}}}getWeightedComputerMove(){let e=this.getComputerTaraCount()>0,t=this.getAvailableMoves(e),s=this.getComputerMoveWeights(t);return this.chooseWeightedRandomMove(t,s)}setPlayerMove(e){this.setMove(h,e)}getPlayerMove(){return this.getMove(h)}setComputerMove(e){this.setMove(u,e)}getComputerMove(){return this.getMove(u)}resetMoves(){this.setPlayerMove(null),this.setComputerMove(null)}chooseComputerMove(){let e=this.getWeightedComputerMove();this.registerComputerMove(e)}registerPlayerMove(e){this.setPlayerMove(e),this.isStandardMove(e)&&(this.setMoveCounts(h,e),this.setPlayerMostCommonMove())}registerComputerMove(e){this.setComputerMove(e),this.isStandardMove(e)&&(this.setMoveCounts(u,e),this.setComputerMostCommonMove())}setPlayerMostCommonMove(){let e=this.getMoveCounts(h);this.setMostCommonMove(h,e)}setComputerMostCommonMove(){let e=this.getMoveCounts(u);this.setMostCommonMove(u,e)}resetMostCommonMoves(){this.resetMostCommonMove(h),this.resetMostCommonMove(u)}getPlayerMostCommonMove(){return this.getMostCommonMove(h)}getComputerMostCommonMove(){return this.getMostCommonMove(u)}setMoveCounts(e,t){this.state.moveCounts[e][t]=(this.state.moveCounts[e][t]||0)+1,this.gameStorage.setMoveCounts(e,this.state.moveCounts[e])}resetMoveCounts(e){this.state.moveCounts[e]={rock:0,paper:0,scissors:0},this.gameStorage.removeMoveCounts(e)}getMoveCounts(e){return this.state.moveCounts[e]}resetBothMoveCounts(){this.resetMoveCounts(h),this.resetMoveCounts(u)}showMostCommonMove(){return null!==this.getPlayerMostCommonMove()||null!==this.getComputerMostCommonMove()}resetHistory(e){this.gameStorage.removeHistory(e)}resetHistories(){this.resetHistory(h),this.resetHistory(u)}getRoundNumber(){return this.state.currentMatch?.matchRoundNumber??1}setRoundNumber(e){this.state.currentMatch&&(this.state.currentMatch.matchRoundNumber=e,this.gameStorage.setMatch(this.state.currentMatch))}increaseRoundNumber(){let e=this.getRoundNumber();this.setRoundNumber(e+1)}isTie(){let e=this.getPlayerMove(),t=this.getComputerMove();return e===s.TARA&&t===s.TARA?"tara-tie":null!==e&&null!==t&&e===t}decrementTaraCount(e){let t=this.getTaraCount(e);t>1?this.setTaraCount(e,t-1):1===t&&this.resetTaraCount(e)}handleTaraMove(e,t){t===s.TARA&&(this.getTaraCount(e)>0?this.decrementTaraCount(e):this.setMove(e,s.ROCK))}setTaraCount(e,t){this.state.taras[e]=t,this.gameStorage.setTaraCount(e,t)}getTaraCount(e){return this.state.taras[e]}resetTaraCount(e){this.state.taras[e]=0,this.gameStorage.removeTaraCount(e)}taraInPlay(){let e=this.getPlayerMove(),t=this.getComputerMove();return"tara-tie"===this.isTie()||e===s.TARA||t===s.TARA}setPlayerTaraCount(e){this.setTaraCount(h,e)}setComputerTaraCount(e){this.setTaraCount(u,e)}resetTaras(){this.resetTaraCount(h),this.resetTaraCount(u)}getPlayerTaraCount(){return this.getTaraCount(h)}getComputerTaraCount(){return this.getTaraCount(u)}taraIsEnabled(){return this.getTaraCount(h)>0}handleMatchWin(){let e=this.getMatchWinner();return"draw"!==e&&this.setScore(e,this.getScore(e)+1),e}isDoubleKO(){return!!this.isMatchOver()&&0===this.getHealth(h)&&0===this.getHealth(u)}setMatch(e){this.state.currentMatch=e,this.gameStorage.setMatch(e)}setMatchNumber(e){this.state.globalMatchNumber=e,this.gameStorage.setGlobalMatchNumber(e)}setDefaultMatchData(){this.isMatchActive()||this.setMatch({...c})}resetMatchData(){this.state.currentMatch=null,this.gameStorage.setMatch(null),this.setMatchNumber(null)}getMatchNumber(){return this.state.globalMatchNumber??1}isMatchOver(){return this.isDefeated(h)||this.isDefeated(u)}getMatchWinner(){let e=this.isDefeated(h),t=this.isDefeated(u);return e&&t?"draw":e?u:t?h:"draw"}incrementMatchNumber(){let e=this.getMatchNumber();this.setMatchNumber(e+1)}_loadOrMigrateMatchState(){if(this.isMatchActive())return void this._loadExistingMatchState();let e=this.gameStorage.getOldGlobalRoundNumber();null!==e&&e>0&&this._migrateOldData(e)}_loadExistingMatchState(){this.state.globalMatchNumber=this.gameStorage.getGlobalMatchNumber(),this.state.currentMatch=this.gameStorage.getMatch()}_migrateOldData(e){this.setMatch({matchRoundNumber:e,playerHealth:100,computerHealth:100,initialHealth:100,damagePerLoss:50}),this.gameStorage.removeOldGlobalRoundNumber(),this.state.globalMatchNumber=1,this.gameStorage.setGlobalMatchNumber(this.state.globalMatchNumber)}getHealthKey(e){return d[e]}getHealth(e){let t=this.state.currentMatch;if(!t)return null;let s=t[this.getHealthKey(e)];return null!=s?s:null}getDamageAmount(e,t){return"tara-tie"===e?20:e?10:t?70:50}decrementHealth(e,t){let s=this.state.currentMatch;if(!s)return!1;let a=this.getHealthKey(e),i={...s,[a]:Math.max(0,(s[a]??0)-t)};return this.setMatch(i),!0}isDefeated(e){let t=this.getHealth(e);return null!==t&&t<=0}}class E{model;announcementView;controlsView;gameView;menuView;moveRevealView;progressView;statsView;statusView;constructor(e,t){this.model=e,this.announcementView=t.announcementView,this.controlsView=t.controlsView,this.gameView=t.gameView,this.menuView=t.menuView,this.moveRevealView=t.moveRevealView,this.progressView=t.progressView,this.statsView=t.statsView,this.statusView=t.statusView}updateControlsView(){this.controlsView.render({playerMove:this.model.getPlayerMove(),isMatchOver:this.model.isMatchOver(),taraIsEnabled:this.model.taraIsEnabled(),moves:l})}updateProgressView(e){this.progressView.update({matchNumber:this.model.getMatchNumber(),roundNumber:this.model.getRoundNumber(),isVisible:e.isVisible})}updateScoreView(){this.statsView.updateScores(this.model.getPlayerScore(),this.model.getComputerScore())}updateTaraView(){this.statsView.updateTaraCounts(this.model.getPlayerTaraCount(),this.model.getComputerTaraCount())}updateMostCommonMoveView(){this.statsView.updateMostCommonMoves(this.model.getPlayerMostCommonMove(),this.model.getComputerMostCommonMove())}updateHealthView(){let e=this.model.getHealth(h),t=this.model.getHealth(u);this.statsView.updateHealthBar(h,e),this.statsView.updateHealthBar(u,t)}async startGame(){this.model.setDefaultMatchData(),this.gameView.toggleVisibility(!0),this.updateProgressView({isVisible:!0}),this.menuView.toggleMenuVisibility(!1),this.statsView.toggleGameStatsVisibility(!0),this.statusView.setMessage("Get ready..."),this.updateControlsView(),this.updateHealthView(),this.controlsView.toggleVisibility(!0),await this.controlsView.flipAll(!0),this.statusView.setMessage("Choose your attack!")}endRound(e){let t=this.model.getPlayerMove(),s=this.model.getComputerMove(),a=this.model.isMatchOver(),i=this.model.isDoubleKO();this.updateHealthView();let r=e.toUpperCase();if(a){let e=this.model.handleMatchWin();r=i?"DOUBLE KO! NOBODY WINS!":`${e.toUpperCase()} WON THE MATCH!`,this.model.incrementMatchNumber(),this.model.setMatch(null)}else this.model.increaseRoundNumber();this.statusView.setMessage(`You played ${m[t]}. Computer played ${m[s]}.`),this.announcementView.setMessage(r),this.controlsView.render({playerMove:this.model.getPlayerMove(),isMatchOver:a,taraIsEnabled:this.model.taraIsEnabled(),moves:l}),this.updateScoreView(),this.updateTaraView(),this.updateMostCommonMoveView()}async handleNextRound(){this.model.resetMoves(),this.model.setDefaultMatchData(),this.updateHealthView(),this.updateProgressView({isVisible:!0}),this.announcementView.setMessage(""),this.moveRevealView.toggleVisibility(!1),this.updateControlsView(),this.statusView.setMessage("Prepare your next move..."),await this.controlsView.flipAll(!0),this.statusView.setMessage("Choose your attack!")}async resetGameState(){this.model.resetScores(),this.model.resetMoves(),this.model.resetTaras(),this.model.resetHistories(),this.model.resetBothMoveCounts(),this.model.resetMostCommonMoves(),this.model.resetMatchData();let e=this.model.isMatchActive();this.updateScoreView(),this.updateTaraView(),this.updateHealthView(),this.updateMostCommonMoveView(),this.updateControlsView(),this.moveRevealView.toggleVisibility(!1),this.controlsView.toggleVisibility(!1),this.menuView.updateMenu({isMatchActive:e}),this.announcementView.setMessage("")}async handlePlayerMove(e){this.model.registerPlayerMove(e),this.model.chooseComputerMove(),this.statusView.setMessage("Locking in move..."),await this.controlsView.flipAll(!1),this.moveRevealView.render({playerMoveId:this.model.getPlayerMove(),computerMoveId:this.model.getComputerMove()}),this.moveRevealView.toggleVisibility(!0),await this.moveRevealView.animateEntrance(),await this.moveRevealView.flipCards();let t=this.model.getPlayerMove(),s=this.model.getComputerMove(),a=this.model.evaluateRound();if(t&&s)if(await this.moveRevealView.playFightAnimations(t,s),t!==s){let e=this.model.doesMoveBeat(t,s);await this.executeOutcomeDrama(e)}else this.updateHealthView(),await this.moveRevealView.triggerImpact("both"),await this.moveRevealView.triggerDefeat("both");this.endRound(a)}async executeOutcomeDrama(e){if(this.model.isDoubleKO())return void await this.executeDoubleKODrama();let t=e?"player":"computer",s=e?"computer":"player";this.statusView.setMessage(`${t.toUpperCase()} LANDS A BLOW!`);let a=this.moveRevealView.triggerImpact(s);this.updateHealthView(),await a,await Promise.all([this.moveRevealView.highlightWinner(t),this.moveRevealView.triggerDefeat(s)])}async executeDoubleKODrama(){this.statusView.setMessage("MUTUAL DESTRUCTION!");let e=this.moveRevealView.triggerImpact("both");this.updateHealthView(),await e,await this.moveRevealView.triggerDefeat("both")}async initialize(){let e=this.model.isMatchActive();this.menuView.render({isMatchActive:e}),this.progressView.render({matchNumber:this.model.getMatchNumber(),roundNumber:this.model.getRoundNumber(),isVisible:!1}),this.announcementView.render({message:""}),this.statusView.render({message:""}),this.updateControlsView(),this.updateScoreView(),this.updateTaraView(),this.updateMostCommonMoveView(),this.menuView.updateMenu({isMatchActive:e}),this.statsView.toggleGameStatsVisibility(!1),this.controlsView.toggleVisibility(!1),this.menuView.toggleMenuVisibility(!0),this.menuView.bindStartMatch(()=>this.startGame()),this.menuView.bindResetGame(()=>this.resetGameState()),this.controlsView.bindPlayerMove(e=>this.handlePlayerMove(e)),this.controlsView.bindNextRound(()=>this.handleNextRound())}}class V{_data;_parentElement;render(e){if(!e)return;this._data=e;let t=this._generateMarkup();this._clear(),this._parentElement.insertAdjacentHTML("afterbegin",t)}update(e){this._data=e;let t=this._generateMarkup(),s=Array.from(document.createRange().createContextualFragment(t).querySelectorAll("*")),a=Array.from(this._parentElement.querySelectorAll("*"));s.forEach((e,t)=>{let s=a[t];e.isEqualNode(s)||e.firstChild?.nodeValue?.trim()===""||e.firstChild?.nodeValue?.trim()===void 0||(s.textContent=e.textContent),e.isEqualNode(s)||(Array.from(e.attributes).forEach(e=>s.setAttribute(e.name,e.value)),Array.from(s.attributes).forEach(t=>{e.hasAttribute(t.name)||s.removeAttribute(t.name)}))})}_clear(){this._parentElement.innerHTML=""}_getElement(e){let t=document.getElementById(e);if(!t)throw Error(`Element #${e} not found.`);return t}_toggleVisibility(e,t){e.classList.toggle("hidden",!t),t?e.removeAttribute("inert"):e.setAttribute("inert","")}_waitForAnimation(e,t=5e3){return new Promise(s=>{let a=getComputedStyle(e),i=e=>Math.max(...e.split(",").map(e=>1e3*(parseFloat(e)||0))),r=Math.max(i(a.transitionDuration),i(a.animationDuration));if(0===r)return void s();let o=!1,n=setTimeout(()=>{o||(o=!0,s())},Math.min(r+50,t)),l=t=>{t.target===e&&(e.removeEventListener("transitionend",l),e.removeEventListener("animationend",l),o||(o=!0,clearTimeout(n),s()))};e.addEventListener("transitionend",l),e.addEventListener("animationend",l)})}}class f extends V{_messageElement=null;render(e){this._parentElement=this._getElement("announcement-container"),super.render(e),this._messageElement=this._parentElement.querySelector("#announcement")}_generateMarkup(){return`<h2 id="announcement">${this._data.message}</h2>`}setMessage(e){if(this._data={message:e},this._messageElement)this._messageElement.textContent=e;else{let t=document.getElementById("announcement");t&&(t.textContent=e)}}}class R extends V{_moveHandler;_nextRoundHandler;_isFaceUp=!1;render(e){this._parentElement=this._getElement("game-controls"),super.render(e),this._setupListeners()}async flipAll(e){this._isFaceUp=e;let t=this._parentElement.querySelectorAll(".card-inner");0!==t.length&&(e?this._parentElement.classList.remove("interaction-locked"):this._parentElement.classList.add("interaction-locked"),t[0].offsetHeight,t.forEach(t=>{e?t.classList.add("is-flipped"):t.classList.remove("is-flipped")}),await this._waitForAnimation(t[0]))}_generateMarkup(){let{playerMove:e,isMatchOver:t,moves:s,taraIsEnabled:a}=this._data;return e?`
    <div id="progression-zone" aria-live="polite">
      <button id="play-again" class="btn-primary">
        ${t?"Start New Match":"Next Round"}
      </button>
    </div>`:`
      <div id="choices" role="group" aria-label="Select your move">
        ${s.map(e=>{let t="tara"===e.id&&!a,s=this._isFaceUp?"is-flipped":"";return`
            <button id="${e.id}" class="card-button" ${t?"disabled":""}>
              <div class="card-inner ${s}">
                <div class="card-back player-theme"></div>
                <div class="card-front">
                  <span class="icon" aria-hidden="true">${e.icon}</span>
                  <span class="label">${e.text}</span>
                </div>
              </div>
            </button>`}).join("")}
      </div>`}toggleVisibility(e){this._parentElement||(this._parentElement=this._getElement("game-controls")),this._toggleVisibility(this._parentElement,e)}bindPlayerMove(e){this._moveHandler=e}bindNextRound(e){this._nextRoundHandler=e}_setupListeners(){this._parentElement.onclick=e=>{let t=e.target;if(t.closest("#play-again")&&this._nextRoundHandler&&this._nextRoundHandler(),!this._isFaceUp)return;let s=t.closest(".card-button");s&&!s.disabled&&this._moveHandler&&this._moveHandler(s.id)}}}class A extends V{_ensureParentElement(){this._parentElement&&document.body.contains(this._parentElement)||(this._parentElement=this._getElement("game-container"))}toggleVisibility(e){this._ensureParentElement(),this._toggleVisibility(this._parentElement,e)}_generateMarkup(){return""}}class T extends V{_startBtn;_resetBtn;_generateMarkup(){let e=this._data.isMatchActive?"Continue Match":"Start Match";return`
      <div class="menu-content">
        <h1 id="game-title" class="title-large">Rock Paper Scissors Tara</h1>
        <div class="menu-controls">
          <button id="start" class="btn-primary">${e}</button>
          <button id="reset-game-state" class="btn-secondary">Reset Game State</button>
        </div>
      </div>
    `}_ensureParentElement(){this._parentElement&&document.body.contains(this._parentElement)||(this._parentElement=this._getElement("main-menu"))}render(e){this._ensureParentElement(),super.render(e),this._startBtn=this._getElement("start"),this._resetBtn=this._getElement("reset-game-state")}bindStartMatch(e){this._startBtn?.addEventListener("click",t=>{t.preventDefault(),e()})}bindResetGame(e){this._resetBtn?.addEventListener("click",t=>{t.preventDefault(),e()})}toggleMenuVisibility(e){this._ensureParentElement(),this._toggleVisibility(this._parentElement,e)}updateMenu(e){this._data={...this._data,...e},this.update(this._data),this._startBtn=this._getElement("start"),this._resetBtn=this._getElement("reset-game-state")}}class P extends V{_parentElement=document.getElementById("move-reveal");_generateMarkup(){let{playerMoveId:e,computerMoveId:t}=this._data,s=l.find(t=>t.id===e),a=l.find(e=>e.id===t);return s&&a?`
      <div class="card entering-player" id="reveal-player" style="--facing: 1;">
        <div class="card-inner">
          <div class="card-back player-theme"></div>
          <div class="card-front">
            <span class="icon">${s.icon}</span>
            <span class="label">${s.text}</span>
          </div>
        </div>
      </div>
      <span class="vs-label">VS</span>
      <div class="card entering-computer" id="reveal-computer" style="--facing: -1;">
        <div class="card-inner">
          <div class="card-back computer-theme"></div>
          <div class="card-front">
            <span class="icon">${a.icon}</span>
            <span class="label">${a.text}</span>
          </div>
        </div>
      </div>
    `:""}async animateEntrance(){let e=this._getElement("reveal-player"),t=this._getElement("reveal-computer");e.classList.remove("slide-in"),t.classList.remove("slide-in"),await new Promise(e=>requestAnimationFrame(()=>requestAnimationFrame(e))),e.classList.add("slide-in"),t.classList.add("slide-in"),await this._waitForAnimation(e)}toggleVisibility(e){e||this._parentElement.querySelectorAll(".card").forEach(e=>{e.className="card",e.style.filter="",e.style.opacity="",e.style.transform=""}),this._toggleVisibility(this._parentElement,e)}async flipCards(){let e=this._parentElement.querySelectorAll(".card-inner");0!==e.length&&(await new Promise(e=>setTimeout(e,300)),e.forEach(e=>{e.classList.add("is-flipped")}),await this._waitForAnimation(e[0]))}async highlightWinner(e){let t=this._parentElement.querySelector(e===h?".player-theme":".computer-theme")?.closest(".card");t&&(t.classList.add("winner-highlight"),await this._waitForAnimation(t))}async playFightAnimations(e,t){let s=this._getElement("reveal-player"),a=this._getElement("reveal-computer");s.classList.add(`stance-${e}`),a.classList.add(`stance-${t}`),("rock"===e||"rock"===t)&&(this._parentElement.classList.add("arena-shake"),await this._waitForAnimation(this._parentElement),this._parentElement.classList.remove("arena-shake")),await Promise.all([this._waitForAnimation(s),this._waitForAnimation(a)])}async applyImpact(e){let t=this._getElement(`reveal-${e}`);t.classList.add("card-impact"),this._parentElement.classList.add("arena-shake"),await this._waitForAnimation(t),t.classList.remove("card-impact"),this._parentElement.classList.remove("arena-shake")}async triggerImpact(e){"both"===e?await Promise.all([this.applyImpact(h),this.applyImpact(u)]):await this.applyImpact(e)}async applyDefeat(e){this._getElement(`reveal-${e}`).classList.add("card-defeated")}async triggerDefeat(e){"both"===e?await Promise.all([this.applyDefeat(h),this.applyDefeat(u)]):await this.applyDefeat(e)}}class N extends V{_ensureParentElement(){this._parentElement&&document.body.contains(this._parentElement)||(this._parentElement=this._getElement("game-progress-container"))}_generateMarkup(){return`
      <h2 id="match">Match ${this._data.matchNumber}</h1>
      <h1 id="round">Round ${this._data.roundNumber}</h2>
    `}render(e){this._ensureParentElement(),super.render(e),this._toggleVisibility(this._parentElement,e.isVisible)}update(e){this._ensureParentElement(),super.update(e),this._toggleVisibility(this._parentElement,e.isVisible)}}class I extends V{get _computerHealthBarElement(){return this._getElement("computer-health")}get _computerMostCommonMoveElement(){return this._getElement("computer-most-common-move")}get _computerScoreElement(){return this._getElement("computer-score")}get _computerTaraCountElement(){return this._getElement("computer-tara")}get _playerHealthBarElement(){return this._getElement("player-health")}get _playerMostCommonMoveElement(){return this._getElement("player-most-common-move")}get _playerScoreElement(){return this._getElement("player-score")}get _playerTaraCountElement(){return this._getElement("player-tara")}_generateMarkup(){return""}render(){this._parentElement=this._getElement("game-stats")}toggleGameStatsVisibility(e){this._parentElement=this._getElement("game-stats"),this._toggleVisibility(this._parentElement,e)}updateHealthBar(e,t){this._getHealthBar(e).style.width=`${t}%`}_getHealthBar(e){return"player"===e?this._playerHealthBarElement:this._computerHealthBarElement}updateMostCommonMoves(e,t){this._playerMostCommonMoveElement.textContent=e??"N/A",this._computerMostCommonMoveElement.textContent=t??"N/A"}updateScores(e,t){this._playerScoreElement.textContent=e.toString().padStart(2,"0"),this._computerScoreElement.textContent=t.toString().padStart(2,"0")}updateTaraCounts(e,t){this._playerTaraCountElement.textContent=e.toString(),this._computerTaraCountElement.textContent=t.toString()}}class H extends V{_messageElement=null;render(e){this._parentElement=this._getElement("status-container"),super.render(e),this._messageElement=this._parentElement.querySelector("#status")}_generateMarkup(){return`<p id="status">${this._data.message}</p>`}setMessage(e){if(this._data={message:e},this._messageElement)this._messageElement.textContent=e;else{let t=document.getElementById("status");t&&(t.textContent=e)}}}document.addEventListener("DOMContentLoaded",()=>{new E(new b,{announcementView:new f,controlsView:new R,gameView:new A,menuView:new T,moveRevealView:new P,progressView:new N,statsView:new I,statusView:new H}).initialize()});
//# sourceMappingURL=public.ccc5e429.js.map
