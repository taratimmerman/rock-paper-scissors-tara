const e={PLAYER:"player",COMPUTER:"computer"},t={ROCK:"rock",PAPER:"paper",SCISSORS:"scissors",TARA:"tara"},o=[{name:t.ROCK,beats:[t.SCISSORS]},{name:t.PAPER,beats:[t.ROCK]},{name:t.SCISSORS,beats:[t.PAPER]},{name:t.TARA,beats:[t.ROCK,t.PAPER,t.SCISSORS]}],s=new Map(o.map(e=>[e.name,e])),r=o.filter(e=>e.name!==t.TARA);r.map(e=>[e.name,e]);class a{state={scores:{player:0,computer:0},moves:{player:null,computer:null},taras:{player:0,computer:0},mostCommonMove:{player:null,computer:null},moveCounts:{player:{rock:0,paper:0,scissors:0},computer:{rock:0,paper:0,scissors:0}},roundNumber:1};constructor(){this.state.scores.player=this.getPlayerScoreFromStorage(),this.state.scores.computer=this.getComputerScoreFromStorage(),this.state.taras.player=this.getPlayerTaraCountFromStorage(),this.state.taras.computer=this.getComputerTaraCountFromStorage(),this.state.mostCommonMove.player=this.getPlayerMostCommonMoveFromStorage(),this.state.mostCommonMove.computer=this.getComputerMostCommonMoveFromStorage(),this.state.moveCounts.player=this.getMoveCountsFromStorage(e.PLAYER),this.state.moveCounts.computer=this.getMoveCountsFromStorage(e.COMPUTER),this.state.roundNumber=this.getRoundNumberFromStorage()}doesMoveBeat(e,t){return s.get(e)?.beats.includes(t)??!1}handleRoundWin(e,t){if(this.setScore(e,this.getScore(e)+1),this.isStandardMove(t)){let t=this.getTaraCount(e);t<3&&this.setTaraCount(e,t+1)}}evaluateRound(){let t=this.getPlayerMove(),o=this.getComputerMove();return null===t||null===o?"Invalid round":(this.handleTaraMove(e.PLAYER,t),this.handleTaraMove(e.COMPUTER,o),t===o)?"It's a tie!":this.doesMoveBeat(t,o)?(this.handleRoundWin(e.PLAYER,t),"You win!"):(this.handleRoundWin(e.COMPUTER,o),"Computer wins!")}setScore(e,t){this.state.scores[e]=t,localStorage.setItem(`${e}Score`,t.toString())}getScoreFromStorage(e){return parseInt(localStorage.getItem(`${e}Score`)||"0",10)}getPlayerScoreFromStorage(){return this.getScoreFromStorage(e.PLAYER)}getComputerScoreFromStorage(){return this.getScoreFromStorage(e.COMPUTER)}getScore(e){return this.state.scores[e]}setPlayerScore(t){this.setScore(e.PLAYER,t)}setComputerScore(t){this.setScore(e.COMPUTER,t)}getPlayerScore(){return this.getScore(e.PLAYER)}getComputerScore(){return this.getScore(e.COMPUTER)}resetScores(){this.setPlayerScore(0),this.setComputerScore(0)}isStandardMove(e){return"string"==typeof e&&e!==t.TARA}setMove(e,t){this.state.moves[e]=t}getMove(e){return this.state.moves[e]}determineMostCommonMove(e){let t=null,o=0,s=!1;for(let[r,a]of Object.entries(e))a>o?(o=a,t=r,s=!1):a===o&&0!==a&&(s=!0);return s?null:t}resetMostCommonMove(e){this.state.mostCommonMove[e]=null,localStorage.removeItem(`${e}MostCommonMove`)}setMostCommonMove(e,t){let o=this.determineMostCommonMove(t);o?(this.state.mostCommonMove[e]=o,localStorage.setItem(`${e}MostCommonMove`,o.toString())):this.resetMostCommonMove(e)}getMostCommonMoveFromStorage(e){let t=localStorage.getItem(`${e}MostCommonMove`);return t&&this.isStandardMove(t)?t:null}getPlayerMostCommonMoveFromStorage(){return this.getMostCommonMoveFromStorage(e.PLAYER)}getComputerMostCommonMoveFromStorage(){return this.getMostCommonMoveFromStorage(e.COMPUTER)}getMostCommonMove(e){return this.state.mostCommonMove[e]}getAvailableMoves(e){return e?o.map(e=>e.name):r.map(e=>e.name)}getBaseWeights(){return{[t.ROCK]:1,[t.PAPER]:1,[t.SCISSORS]:1,[t.TARA]:0}}getTaraWeight(e){if(!e.includes(t.TARA))return null;let{player:o,computer:s}=this.state.scores,r=o-s;return r>0?Math.min(3+r,10):r<0?1:2}getStandardMoveWeights(){let e={[t.ROCK]:1,[t.PAPER]:1,[t.SCISSORS]:1},o=this.state.mostCommonMove.player;if(!o)return e;let s={[t.ROCK]:t.PAPER,[t.PAPER]:t.SCISSORS,[t.SCISSORS]:t.ROCK}[o];return{[t.ROCK]:s===t.ROCK?5:2,[t.PAPER]:s===t.PAPER?5:2,[t.SCISSORS]:s===t.SCISSORS?5:2}}chooseWeightedRandomMove(e,t){let o=e.flatMap(e=>Array(t[e]).fill(e)),s=Math.floor(Math.random()*o.length);return o[s]}getComputerMoveWeights(e){let o=this.getBaseWeights(),s=this.getTaraWeight(e),r=this.getStandardMoveWeights();return{...o,...r,...null!==s?{[t.TARA]:s}:{}}}getWeightedComputerMove(){let e=this.getComputerTaraCount()>0,t=this.getAvailableMoves(e),o=this.getComputerMoveWeights(t);return this.chooseWeightedRandomMove(t,o)}setPlayerMove(t){this.setMove(e.PLAYER,t)}getPlayerMove(){return this.getMove(e.PLAYER)}setComputerMove(t){this.setMove(e.COMPUTER,t)}getComputerMove(){return this.getMove(e.COMPUTER)}resetMoves(){this.setPlayerMove(null),this.setComputerMove(null)}chooseComputerMove(){let e=this.getWeightedComputerMove();this.registerComputerMove(e)}registerPlayerMove(t){this.setPlayerMove(t),this.isStandardMove(t)&&(this.setMoveCounts(e.PLAYER,t),this.setPlayerMostCommonMove())}registerComputerMove(t){this.setComputerMove(t),this.isStandardMove(t)&&(this.setMoveCounts(e.COMPUTER,t),this.setComputerMostCommonMove())}setPlayerMostCommonMove(){let t=this.getMoveCounts(e.PLAYER);this.setMostCommonMove(e.PLAYER,t)}setComputerMostCommonMove(){let t=this.getMoveCounts(e.COMPUTER);this.setMostCommonMove(e.COMPUTER,t)}resetMostCommonMoves(){this.resetMostCommonMove(e.PLAYER),this.resetMostCommonMove(e.COMPUTER)}getPlayerMostCommonMove(){return this.getMostCommonMove(e.PLAYER)}getComputerMostCommonMove(){return this.getMostCommonMove(e.COMPUTER)}setMoveCounts(e,t){this.state.moveCounts[e][t]=(this.state.moveCounts[e][t]||0)+1;try{localStorage.setItem(`${e}MoveCounts`,JSON.stringify(this.state.moveCounts[e]))}catch(t){console.warn(`Failed to save ${e} data to localStorage`,t)}}getMoveCountsFromStorage(e){try{let t=localStorage.getItem(`${e}MoveCounts`);return t?JSON.parse(t):{rock:0,paper:0,scissors:0}}catch{return{rock:0,paper:0,scissors:0}}}resetMoveCounts(e){this.state.moveCounts[e]={rock:0,paper:0,scissors:0},localStorage.removeItem(`${e}MoveCounts`)}getMoveCounts(e){return this.state.moveCounts[e]}resetBothMoveCounts(){this.resetMoveCounts(e.PLAYER),this.resetMoveCounts(e.COMPUTER)}showMostCommonMove(){return this.getRoundNumber()>1&&(null!==this.getPlayerMostCommonMove()||null!==this.getComputerMostCommonMove())}resetHistory(e){try{localStorage.removeItem(`${e}History`)}catch(t){console.warn(`Failed to remove ${e} history from localStorage`,t)}}resetHistories(){this.resetHistory(e.PLAYER),this.resetHistory(e.COMPUTER)}getRoundNumberFromStorage(){return parseInt(localStorage.getItem("roundNumber")||"1",10)}getRoundNumber(){return this.state.roundNumber}setRoundNumber(e){this.state.roundNumber=e,localStorage.setItem("roundNumber",e.toString())}increaseRoundNumber(){this.setRoundNumber(this.getRoundNumber()+1)}resetRoundNumber(){this.setRoundNumber(1)}getTaraCountFromStorage(e){return parseInt(localStorage.getItem(`${e}TaraCount`)||"0",10)}getPlayerTaraCountFromStorage(){return this.getTaraCountFromStorage(e.PLAYER)}getComputerTaraCountFromStorage(){return this.getTaraCountFromStorage(e.COMPUTER)}decrementTaraCount(e){let t=this.getTaraCount(e);t>0&&this.setTaraCount(e,t-1)}handleTaraMove(e,o){o===t.TARA&&(this.getTaraCount(e)>0?this.decrementTaraCount(e):this.setMove(e,t.ROCK))}setTaraCount(e,t){this.state.taras[e]=t,localStorage.setItem(`${e}TaraCount`,t.toString())}getTaraCount(e){return this.state.taras[e]}setPlayerTaraCount(t){this.setTaraCount(e.PLAYER,t)}setComputerTaraCount(t){this.setTaraCount(e.COMPUTER,t)}resetTaras(){this.setPlayerTaraCount(0),this.setComputerTaraCount(0)}getPlayerTaraCount(){return this.getTaraCount(e.PLAYER)}getComputerTaraCount(){return this.getTaraCount(e.COMPUTER)}taraIsEnabled(){return this.getTaraCount(e.PLAYER)>0}}class n{messageEl=document.getElementById("message");playerScoreEl=document.getElementById("player-score");computerScoreEl=document.getElementById("computer-score");playerMostCommonMoveEl=document.getElementById("player-most-common-move");computerMostCommonMoveEl=document.getElementById("computer-most-common-move");movesEl=document.getElementById("round-moves");resultEl=document.getElementById("round-result");taraBtn=document.getElementById("tara");updateMessage(e){this.messageEl&&(this.messageEl.textContent=e)}toggleStartButton(e){let t=document.getElementById("start-game");t&&(t.style.display=e?"inline":"none")}updateRound(e){let t=document.getElementById("round");t&&(t.textContent=`Round ${e}`,t.style.display="block")}showRoundOutcome(e,t,o){this.movesEl.textContent=`You played ${e}. Computer played ${t}.`,this.resultEl.textContent=o.toUpperCase(),this.movesEl.style.display="block",this.resultEl.style.display="block"}toggleResetGameState(e){let t=document.getElementById("reset-game-state");t&&(t.style.display=e?"inline-block":"none")}toggleMoveButtons(e){Object.values(t).forEach(t=>{let o=document.getElementById(t);o&&(o.style.display=e?"inline":"none")})}togglePlayAgain(e){let t=document.getElementById("play-again");t&&(t.style.display=e?"inline-block":"none")}toggleMostCommonMoveTable(e){let t=document.getElementById("most-common-move-table");t&&(t.style.display=e?"table":"none")}resetForNextRound(){this.toggleMostCommonMoveTable(!0),this.toggleMoveButtons(!0),this.togglePlayAgain(!1),this.movesEl.style.display="none",this.resultEl.style.display="none"}updateScores(e,t){this.playerScoreEl&&(this.playerScoreEl.textContent=e.toString()),this.computerScoreEl&&(this.computerScoreEl.textContent=t.toString())}updateTaraCounts(e,t){document.getElementById("player-tara").textContent=e.toString(),document.getElementById("computer-tara").textContent=t.toString()}updateTaraButton(e,t){this.taraBtn instanceof HTMLButtonElement&&(this.taraBtn.disabled=!e),this.taraBtn.textContent=`Tara (x${t})`}updateMostCommonMoves(e,t){this.playerMostCommonMoveEl&&(this.playerMostCommonMoveEl.textContent=e??"X"),this.computerMostCommonMoveEl&&(this.computerMostCommonMoveEl.textContent=t??"X")}}class m{model;view;constructor(e,t){this.model=e,this.view=t}updateScoreView(){this.view.updateScores(this.model.getPlayerScore(),this.model.getComputerScore())}updateTaraView(){this.view.updateTaraCounts(this.model.getPlayerTaraCount(),this.model.getComputerTaraCount())}updateMostCommonMoveView(){let e=this.model.getPlayerMostCommonMove(),t=this.model.getComputerMostCommonMove();this.view.updateMostCommonMoves(e,t)}updateTaraButtonView(){let e=this.model.taraIsEnabled(),t=this.model.getPlayerTaraCount();this.view.updateTaraButton(e,t)}startGame(){this.view.toggleStartButton(!1),this.view.toggleResetGameState(!1),this.view.toggleMostCommonMoveTable(this.model.showMostCommonMove()),this.view.toggleMoveButtons(!0),this.view.updateRound(this.model.getRoundNumber())}endRound(){let e=this.model.getPlayerMove(),t=this.model.getComputerMove(),o=this.model.evaluateRound();this.view.showRoundOutcome(e,t,o),this.view.toggleMostCommonMoveTable(!1),this.view.toggleMoveButtons(!1),this.view.togglePlayAgain(!0),this.model.increaseRoundNumber(),this.updateScoreView(),this.updateTaraView(),this.updateMostCommonMoveView(),this.updateTaraButtonView()}handleNextRound(){this.view.updateRound(this.model.getRoundNumber()),this.view.resetForNextRound()}resetGameState(){this.model.resetScores(),this.model.resetMoves(),this.model.resetTaras(),this.model.resetRoundNumber(),this.model.resetHistories(),this.model.resetBothMoveCounts(),this.model.resetMostCommonMoves(),this.updateScoreView(),this.updateTaraView(),this.updateMostCommonMoveView(),this.updateTaraButtonView()}handlePlayerMove(e){this.model.resetMoves(),this.model.registerPlayerMove(e),this.model.chooseComputerMove(),this.endRound()}initialize(){this.view.updateMessage("Rock, Paper, Scissors, Tara"),this.updateScoreView(),this.updateTaraView(),this.updateMostCommonMoveView(),this.updateTaraButtonView(),this.view.toggleMostCommonMoveTable(!1),this.view.toggleMoveButtons(!1),this.view.togglePlayAgain(!1),this.view.toggleStartButton(!0),document.getElementById("start-game")?.addEventListener("click",()=>this.startGame()),document.getElementById("play-again")?.addEventListener("click",()=>this.handleNextRound()),Object.values(t).forEach(e=>{document.getElementById(e)?.addEventListener("click",()=>this.handlePlayerMove(e))}),document.getElementById("reset-game-state")?.addEventListener("click",()=>this.resetGameState())}}document.addEventListener("DOMContentLoaded",()=>{new m(new a,new n).initialize()});
//# sourceMappingURL=public.60a8f138.js.map
