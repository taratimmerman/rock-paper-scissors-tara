const t={PLAYER:"player",COMPUTER:"computer"},e={ROCK:"rock",PAPER:"paper",SCISSORS:"scissors",TARA:"tara"},o=[{name:e.ROCK,beats:[e.SCISSORS]},{name:e.PAPER,beats:[e.ROCK]},{name:e.SCISSORS,beats:[e.PAPER]},{name:e.TARA,beats:[e.ROCK,e.PAPER,e.SCISSORS]}],s=new Map(o.map(t=>[t.name,t])),r=o.filter(t=>t.name!==e.TARA);r.map(t=>[t.name,t]);class a{state={scores:{player:0,computer:0},moves:{player:null,computer:null},taras:{player:0,computer:0},history:{player:[],computer:[]},mostCommonMove:{player:null,computer:null},moveCounts:{player:{rock:0,paper:0,scissors:0},computer:{rock:0,paper:0,scissors:0}},roundNumber:1};constructor(){this.state.scores.player=this.getPlayerScoreFromStorage(),this.state.scores.computer=this.getComputerScoreFromStorage(),this.state.taras.player=this.getPlayerTaraCountFromStorage(),this.state.taras.computer=this.getComputerTaraCountFromStorage(),this.state.history.player=this.getPlayerHistoryFromStorage(),this.state.history.computer=this.getComputerHistoryFromStorage(),this.state.mostCommonMove.player=this.getPlayerMostCommonMoveFromStorage(),this.state.mostCommonMove.computer=this.getComputerMostCommonMoveFromStorage(),this.state.moveCounts.player=this.getMoveCountsFromStorage(t.PLAYER),this.state.moveCounts.computer=this.getMoveCountsFromStorage(t.COMPUTER),this.state.roundNumber=this.getRoundNumberFromStorage()}doesMoveBeat(t,e){return s.get(t)?.beats.includes(e)??!1}handleRoundWin(t,e){if(this.setScore(t,this.getScore(t)+1),this.isStandardMove(e)){let e=this.getTaraCount(t);e<3&&this.setTaraCount(t,e+1)}}evaluateRound(){let e=this.getPlayerMove(),o=this.getComputerMove();return null===e||null===o?"Invalid round":(this.handleTaraMove(t.PLAYER,e),this.handleTaraMove(t.COMPUTER,o),e===o)?"It's a tie!":this.doesMoveBeat(e,o)?(this.handleRoundWin(t.PLAYER,e),"You win!"):(this.handleRoundWin(t.COMPUTER,o),"Computer wins!")}setScore(t,e){this.state.scores[t]=e,localStorage.setItem(`${t}Score`,e.toString())}getScoreFromStorage(t){return parseInt(localStorage.getItem(`${t}Score`)||"0",10)}getPlayerScoreFromStorage(){return this.getScoreFromStorage(t.PLAYER)}getComputerScoreFromStorage(){return this.getScoreFromStorage(t.COMPUTER)}getScore(t){return this.state.scores[t]}setPlayerScore(e){this.setScore(t.PLAYER,e)}setComputerScore(e){this.setScore(t.COMPUTER,e)}getPlayerScore(){return this.getScore(t.PLAYER)}getComputerScore(){return this.getScore(t.COMPUTER)}resetScores(){this.setPlayerScore(0),this.setComputerScore(0)}isStandardMove(t){return"string"==typeof t&&t!==e.TARA}setMove(t,e){this.state.moves[t]=e}getMove(t){return this.state.moves[t]}determineMostCommonMove(t){let e=null,o=0;if(Object.values(t).every(t=>0===t))return null;for(let[s,r]of Object.entries(t))r>o&&(o=r,e=s);return e}setMostCommonMove(t,e){let o=this.determineMostCommonMove(e);o&&(this.state.mostCommonMove[t]=o,localStorage.setItem(`${t}MostCommonMove`,o.toString()))}resetMostCommonMove(t){this.state.mostCommonMove[t]=null,localStorage.removeItem(`${t}MostCommonMove`)}getMostCommonMoveFromStorage(t){let e=localStorage.getItem(`${t}MostCommonMove`);return e&&this.isStandardMove(e)?e:null}getPlayerMostCommonMoveFromStorage(){return this.getMostCommonMoveFromStorage(t.PLAYER)}getComputerMostCommonMoveFromStorage(){return this.getMostCommonMoveFromStorage(t.COMPUTER)}getMostCommonMove(t){return this.state.mostCommonMove[t]}getAvailableMoves(t){return t?o.map(t=>t.name):r.map(t=>t.name)}getBaseWeights(){return{[e.ROCK]:1,[e.PAPER]:1,[e.SCISSORS]:1,[e.TARA]:0}}getTaraWeight(t){if(!t.includes(e.TARA))return null;let{player:o,computer:s}=this.state.scores,r=o-s;return r>0?Math.min(3+r,10):r<0?1:2}getStandardMoveWeights(){let t={[e.ROCK]:1,[e.PAPER]:1,[e.SCISSORS]:1},o=this.state.mostCommonMove.player;if(!o)return t;let s={[e.ROCK]:e.PAPER,[e.PAPER]:e.SCISSORS,[e.SCISSORS]:e.ROCK}[o];return{[e.ROCK]:s===e.ROCK?5:2,[e.PAPER]:s===e.PAPER?5:2,[e.SCISSORS]:s===e.SCISSORS?5:2}}chooseWeightedRandomMove(t,e){let o=t.flatMap(t=>Array(e[t]).fill(t)),s=Math.floor(Math.random()*o.length);return o[s]}getComputerMoveWeights(t){let o=this.getBaseWeights(),s=this.getTaraWeight(t),r=this.getStandardMoveWeights();return{...o,...r,...null!==s?{[e.TARA]:s}:{}}}getWeightedComputerMove(){let t=this.getComputerTaraCount()>0,e=this.getAvailableMoves(t),o=this.getComputerMoveWeights(e);return this.chooseWeightedRandomMove(e,o)}setPlayerMove(e){this.setMove(t.PLAYER,e)}getPlayerMove(){return this.getMove(t.PLAYER)}setComputerMove(e){this.setMove(t.COMPUTER,e)}getComputerMove(){return this.getMove(t.COMPUTER)}resetMoves(){this.setPlayerMove(null),this.setComputerMove(null)}chooseComputerMove(){let t=this.getWeightedComputerMove();this.registerComputerMove(t)}registerPlayerMove(e){this.setPlayerMove(e),this.isStandardMove(e)&&(this.setPlayerHistory(e),this.setMoveCounts(t.PLAYER,e),this.setPlayerMostCommonMove())}registerComputerMove(e){this.setComputerMove(e),this.isStandardMove(e)&&(this.setComputerHistory(e),this.setMoveCounts(t.COMPUTER,e),this.setComputerMostCommonMove())}setPlayerMostCommonMove(){let e=this.getMoveCounts(t.PLAYER);this.setMostCommonMove(t.PLAYER,e)}setComputerMostCommonMove(){let e=this.getMoveCounts(t.COMPUTER);this.setMostCommonMove(t.COMPUTER,e)}resetMostCommonMoves(){this.resetMostCommonMove(t.PLAYER),this.resetMostCommonMove(t.COMPUTER)}getPlayerMostCommonMove(){return this.getMostCommonMove(t.PLAYER)}getComputerMostCommonMove(){return this.getMostCommonMove(t.COMPUTER)}getRoundNumberFromStorage(){return parseInt(localStorage.getItem("roundNumber")||"1",10)}getRoundNumber(){return this.state.roundNumber}setRoundNumber(t){this.state.roundNumber=t,localStorage.setItem("roundNumber",t.toString())}increaseRoundNumber(){this.setRoundNumber(this.getRoundNumber()+1)}resetRoundNumber(){this.setRoundNumber(1)}getTaraCountFromStorage(t){return parseInt(localStorage.getItem(`${t}TaraCount`)||"0",10)}getPlayerTaraCountFromStorage(){return this.getTaraCountFromStorage(t.PLAYER)}getComputerTaraCountFromStorage(){return this.getTaraCountFromStorage(t.COMPUTER)}decrementTaraCount(t){let e=this.getTaraCount(t);e>0&&this.setTaraCount(t,e-1)}handleTaraMove(t,o){o===e.TARA&&(this.getTaraCount(t)>0?this.decrementTaraCount(t):this.setMove(t,e.ROCK))}setTaraCount(t,e){this.state.taras[t]=e,localStorage.setItem(`${t}TaraCount`,e.toString())}getTaraCount(t){return this.state.taras[t]}setPlayerTaraCount(e){this.setTaraCount(t.PLAYER,e)}setComputerTaraCount(e){this.setTaraCount(t.COMPUTER,e)}resetTaras(){this.setPlayerTaraCount(0),this.setComputerTaraCount(0)}getPlayerTaraCount(){return this.getTaraCount(t.PLAYER)}getComputerTaraCount(){return this.getTaraCount(t.COMPUTER)}taraIsEnabled(){return this.getTaraCount(t.PLAYER)>0}setHistory(t,e){this.state.history[t].push(e);try{localStorage.setItem(`${t}History`,JSON.stringify(this.state.history[t]))}catch(e){console.warn(`Failed to save ${t} history to localStorage`,e)}}getHistoryFromStorage(t){try{let e=localStorage.getItem(`${t}History`);return e?JSON.parse(e):[]}catch{return[]}}getPlayerHistoryFromStorage(){return this.getHistoryFromStorage(t.PLAYER)}getComputerHistoryFromStorage(){return this.getHistoryFromStorage(t.COMPUTER)}getHistory(t){return this.state.history[t]}resetHistory(t){this.state.history[t]=[];try{localStorage.removeItem(`${t}History`)}catch(e){console.warn(`Failed to remove ${t} history from localStorage`,e)}}setPlayerHistory(e){this.setHistory(t.PLAYER,e)}setComputerHistory(e){this.setHistory(t.COMPUTER,e)}resetHistories(){this.resetHistory(t.PLAYER),this.resetHistory(t.COMPUTER)}getPlayerHistory(){return this.getHistory(t.PLAYER)}getComputerHistory(){return this.getHistory(t.COMPUTER)}showMostCommonMove(){return this.getRoundNumber()>1&&!!this.getPlayerMostCommonMove()&&!!this.getComputerMostCommonMove()}setMoveCounts(t,e){this.state.moveCounts[t][e]=(this.state.moveCounts[t][e]||0)+1;try{localStorage.setItem(`${t}MoveCounts`,JSON.stringify(this.state.moveCounts[t]))}catch(e){console.warn(`Failed to save ${t} data to localStorage`,e)}}getMoveCountsFromStorage(t){try{let e=localStorage.getItem(`${t}MoveCounts`);return e?JSON.parse(e):{rock:0,paper:0,scissors:0}}catch{return{rock:0,paper:0,scissors:0}}}resetMoveCounts(t){this.state.moveCounts[t]={rock:0,paper:0,scissors:0},localStorage.removeItem(`${t}MoveCounts`)}resetBothMoveCounts(){this.resetMoveCounts(t.PLAYER),this.resetMoveCounts(t.COMPUTER)}getMoveCounts(t){return this.state.moveCounts[t]}}class n{messageEl=document.getElementById("message");playerScoreEl=document.getElementById("player-score");computerScoreEl=document.getElementById("computer-score");playerMostCommonMoveEl=document.getElementById("player-most-common-move");computerMostCommonMoveEl=document.getElementById("computer-most-common-move");movesEl=document.getElementById("round-moves");resultEl=document.getElementById("round-result");taraBtn=document.getElementById("tara");updateMessage(t){this.messageEl&&(this.messageEl.textContent=t)}toggleStartButton(t){let e=document.getElementById("start-game");e&&(e.style.display=t?"inline":"none")}updateRound(t){let e=document.getElementById("round");e&&(e.textContent=`Round ${t}`,e.style.display="block")}showRoundOutcome(t,e,o){this.movesEl.textContent=`You played ${t}. Computer played ${e}.`,this.resultEl.textContent=o.toUpperCase(),this.movesEl.style.display="block",this.resultEl.style.display="block"}toggleResetGameState(t){let e=document.getElementById("reset-game-state");e&&(e.style.display=t?"inline-block":"none")}toggleMoveButtons(t){Object.values(e).forEach(e=>{let o=document.getElementById(e);o&&(o.style.display=t?"inline":"none")})}togglePlayAgain(t){let e=document.getElementById("play-again");e&&(e.style.display=t?"inline-block":"none")}toggleMostCommonMoveTable(t){let e=document.getElementById("most-common-move-table");e&&(e.style.display=t?"table":"none")}resetForNextRound(){this.toggleMostCommonMoveTable(!0),this.toggleMoveButtons(!0),this.togglePlayAgain(!1),this.movesEl.style.display="none",this.resultEl.style.display="none"}updateScores(t,e){this.playerScoreEl&&(this.playerScoreEl.textContent=t.toString()),this.computerScoreEl&&(this.computerScoreEl.textContent=e.toString())}updateTaraCounts(t,e){document.getElementById("player-tara").textContent=t.toString(),document.getElementById("computer-tara").textContent=e.toString()}updateTaraButton(t,e){this.taraBtn instanceof HTMLButtonElement&&(this.taraBtn.disabled=!t),this.taraBtn.textContent=`Tara (x${e})`}updateMostCommonMoves(t,e){this.playerMostCommonMoveEl&&(this.playerMostCommonMoveEl.textContent=t),this.computerMostCommonMoveEl&&(this.computerMostCommonMoveEl.textContent=e)}}class i{model;view;constructor(t,e){this.model=t,this.view=e}updateScoreView(){this.view.updateScores(this.model.getPlayerScore(),this.model.getComputerScore())}updateTaraView(){this.view.updateTaraCounts(this.model.getPlayerTaraCount(),this.model.getComputerTaraCount())}updateMostCommonMoveView(){let t=this.model.getPlayerMostCommonMove(),e=this.model.getComputerMostCommonMove();t&&e&&this.view.updateMostCommonMoves(t,e)}updateTaraButtonView(){let t=this.model.taraIsEnabled(),e=this.model.getPlayerTaraCount();this.view.updateTaraButton(t,e)}startGame(){this.view.toggleStartButton(!1),this.view.toggleResetGameState(!1),this.view.toggleMostCommonMoveTable(this.model.showMostCommonMove()),this.view.toggleMoveButtons(!0),this.view.updateRound(this.model.getRoundNumber())}endRound(){let t=this.model.getPlayerMove(),e=this.model.getComputerMove(),o=this.model.evaluateRound();this.view.showRoundOutcome(t,e,o),this.view.toggleMostCommonMoveTable(!1),this.view.toggleMoveButtons(!1),this.view.togglePlayAgain(!0),this.model.increaseRoundNumber(),this.updateScoreView(),this.updateTaraView(),this.updateMostCommonMoveView(),this.updateTaraButtonView()}handleNextRound(){this.view.updateRound(this.model.getRoundNumber()),this.view.resetForNextRound()}resetGameState(){this.model.resetScores(),this.model.resetMoves(),this.model.resetTaras(),this.model.resetRoundNumber(),this.model.resetHistories(),this.model.resetBothMoveCounts(),this.model.resetMostCommonMoves(),this.updateScoreView(),this.updateTaraView(),this.updateMostCommonMoveView(),this.updateTaraButtonView()}handlePlayerMove(t){this.model.resetMoves(),this.model.registerPlayerMove(t),this.model.chooseComputerMove(),this.endRound()}initialize(){this.view.updateMessage("Rock, Paper, Scissors, Tara"),this.updateScoreView(),this.updateTaraView(),this.updateMostCommonMoveView(),this.updateTaraButtonView(),this.view.toggleMostCommonMoveTable(!1),this.view.toggleMoveButtons(!1),this.view.togglePlayAgain(!1),this.view.toggleStartButton(!0),document.getElementById("start-game")?.addEventListener("click",()=>this.startGame()),document.getElementById("play-again")?.addEventListener("click",()=>this.handleNextRound()),Object.values(e).forEach(t=>{document.getElementById(t)?.addEventListener("click",()=>this.handlePlayerMove(t))}),document.getElementById("reset-game-state")?.addEventListener("click",()=>this.resetGameState())}}document.addEventListener("DOMContentLoaded",()=>{new i(new a,new n).initialize()});
//# sourceMappingURL=public.9361ddc1.js.map
